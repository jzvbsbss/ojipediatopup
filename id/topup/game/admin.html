<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f8fafc;
    }
    
    .status-pending {
      background-color: #fffbeb;
      color: #b45309;
      border: 1px solid #fcd34d;
    }
    .status-completed {
      background-color: #ecfdf5;
      color: #047857;
      border: 1px solid #6ee7b7;
    }
    .status-cancelled {
      background-color: #fef2f2;
      color: #b91c1c;
      border: 1px solid #fca5a5;
    }
    
    .scrollbar-hide::-webkit-scrollbar {
      display: none;
    }
    
    .scrollbar-hide {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    
    .fade-in {
      animation: fadeIn 0.3s ease-in-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .card-shadow {
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
    }
    
    .highlight-row {
      transition: all 0.2s ease;
    }
    
    .highlight-row:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
    }
  </style>
</head>
<body class="bg-gray-50">
  <div class="min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-sm">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
        <div class="flex justify-between items-center">
          <div>
            <h1 class="text-2xl font-bold text-gray-900">
              <span class="text-blue-600">Mobile Legends</span> Orders Dashboard
            </h1>
            <p class="text-sm text-gray-500 mt-1">Manage diamond purchases and orders</p>
          </div>
          <div class="flex items-center space-x-4">
            <div class="relative">
              <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                <i class="fas fa-search text-gray-400"></i>
              </div>
              <input type="text" placeholder="Search orders..." class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
            </div>
            <button id="refreshBtn" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
              <i class="fas fa-sync-alt mr-2"></i> Refresh
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <!-- Stats Cards -->
      <div class="grid grid-cols-1 gap-5 sm:grid-cols-3 mb-8">
        <div class="bg-white overflow-hidden shadow rounded-lg">
          <div class="px-4 py-5 sm:p-6">
            <div class="flex items-center">
              <div class="flex-shrink-0 bg-blue-500 rounded-md p-3">
                <i class="fas fa-shopping-cart text-white"></i>
              </div>
              <div class="ml-5 w-0 flex-1">
                <dt class="text-sm font-medium text-gray-500 truncate">Total Orders</dt>
                <dd class="flex items-baseline">
                  <div class="text-2xl font-semibold text-gray-900" id="totalOrders">--</div>
                </dd>
              </div>
            </div>
          </div>
        </div>
        
        <div class="bg-white overflow-hidden shadow rounded-lg">
          <div class="px-4 py-5 sm:p-6">
            <div class="flex items-center">
              <div class="flex-shrink-0 bg-green-500 rounded-md p-3">
                <i class="fas fa-check-circle text-white"></i>
              </div>
              <div class="ml-5 w-0 flex-1">
                <dt class="text-sm font-medium text-gray-500 truncate">Completed</dt>
                <dd class="flex items-baseline">
                  <div class="text-2xl font-semibold text-gray-900" id="completedOrders">--</div>
                </dd>
              </div>
            </div>
          </div>
        </div>
        
        <div class="bg-white overflow-hidden shadow rounded-lg">
          <div class="px-4 py-5 sm:p-6">
            <div class="flex items-center">
              <div class="flex-shrink-0 bg-yellow-500 rounded-md p-3">
                <i class="fas fa-clock text-white"></i>
              </div>
              <div class="ml-5 w-0 flex-1">
                <dt class="text-sm font-medium text-gray-500 truncate">Pending</dt>
                <dd class="flex items-baseline">
                  <div class="text-2xl font-semibold text-gray-900" id="pendingOrders">--</div>
                </dd>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Orders Table -->
      <div class="bg-white shadow overflow-hidden sm:rounded-lg">
        <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
          <h3 class="text-lg leading-6 font-medium text-gray-900">Recent Orders</h3>
          <p class="mt-1 text-sm text-gray-500">List of all diamond purchase orders from customers</p>
        </div>
        
        <!-- Table Header -->
        <div class="bg-gray-50 grid grid-cols-12 gap-4 px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
          <div class="col-span-1">Order ID</div>
          <div class="col-span-2">Customer</div>
          <div class="col-span-1">Server</div>
          <div class="col-span-1">Diamonds</div>
          <div class="col-span-1">Qty</div>
          <div class="col-span-1">Amount</div>
          <div class="col-span-2">Payment</div>
          <div class="col-span-1">Status</div>
          <div class="col-span-2 text-right">Actions</div>
        </div>
        
        <!-- Orders Container -->
        <div id="ordersContainer" class="divide-y divide-gray-200">
          <!-- Loading state -->
          <div class="py-12 text-center">
            <div class="flex justify-center">
              <i class="fas fa-circle-notch fa-spin text-2xl text-blue-500"></i>
            </div>
            <p class="mt-2 text-sm text-gray-500">Loading orders...</p>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Order Detail Modal -->
  <div id="orderDetailModal" class="fixed z-50 inset-0 overflow-y-auto hidden">
    <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
      <div class="fixed inset-0 transition-opacity" aria-hidden="true">
        <div class="absolute inset-0 bg-gray-500 opacity-75"></div>
      </div>
      
      <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
      
      <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full fade-in">
        <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
          <div class="sm:flex sm:items-start">
            <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
              <div class="flex justify-between items-center">
                <h3 class="text-lg leading-6 font-medium text-gray-900" id="modal-title">
                  Order Details
                </h3>
                <button id="closeDetailModal" type="button" class="text-gray-400 hover:text-gray-500 focus:outline-none">
                  <i class="fas fa-times"></i>
                </button>
              </div>
              
              <div class="mt-4">
                <div id="orderDetailContent" class="space-y-6">
                  <!-- Order details will be loaded here -->
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
          <button id="completeOrderBtn" type="button" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:ml-3 sm:w-auto sm:text-sm hidden">
            <i class="fas fa-check-circle mr-2"></i> Complete Order
          </button>
          <button id="cancelOrderBtn" type="button" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm hidden">
            <i class="fas fa-times-circle mr-2"></i> Cancel Order
          </button>
          <button id="closeModalBtn" type="button" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
            Close
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Initialize Firebase
    const firebaseConfig = {
  apiKey: "AIzaSyAJL3TYPb-lYcaVezaK0HAvd1KO40sy_2s",
  authDomain: "order-oji-pedia.firebaseapp.com",
  databaseURL: "https://order-oji-pedia-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "order-oji-pedia",
  storageBucket: "order-oji-pedia.firebasestorage.app",
  messagingSenderId: "390634204981",
  appId: "1:390634204981:web:c8ced7fecf3f547dc8267c"
};

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // Format number with thousand separator
    function formatNumber(num) {
      return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    }

    // Format date
    function formatDate(timestamp) {
      if (!timestamp) return 'N/A';
      
      const date = new Date(timestamp);
      if (isNaN(date.getTime())) return 'N/A';
      
      const options = { 
        year: 'numeric', 
        month: 'short', 
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      };
      return date.toLocaleDateString('en-US', options);
    }

    // Update stats counters
    function updateStats(orders) {
      if (!orders) {
        document.getElementById('totalOrders').textContent = '0';
        document.getElementById('completedOrders').textContent = '0';
        document.getElementById('pendingOrders').textContent = '0';
        return;
      }
      
      const total = Object.keys(orders).length;
      let completed = 0;
      let pending = 0;
      
      Object.values(orders).forEach(order => {
        if (order.status === 'completed') completed++;
        if (order.status === 'pending') pending++;
      });
      
      document.getElementById('totalOrders').textContent = total;
      document.getElementById('completedOrders').textContent = completed;
      document.getElementById('pendingOrders').textContent = pending;
    }

    // Load orders from Firebase
    function loadOrders() {
      const ordersRef = database.ref('orders');
      const ordersContainer = document.getElementById('ordersContainer');
      
      ordersContainer.innerHTML = `
        <div class="py-12 text-center">
          <div class="flex justify-center">
            <i class="fas fa-circle-notch fa-spin text-2xl text-blue-500"></i>
          </div>
          <p class="mt-2 text-sm text-gray-500">Loading orders...</p>
        </div>
      `;
      
      ordersRef.on('value', (snapshot) => {
        const orders = snapshot.val();
        updateStats(orders);
        
        if (!orders) {
          ordersContainer.innerHTML = `
            <div class="py-12 text-center">
              <i class="fas fa-box-open text-3xl text-gray-400"></i>
              <p class="mt-2 text-sm text-gray-500">No orders found</p>
            </div>
          `;
          return;
        }
        
        ordersContainer.innerHTML = '';
        
        // Convert to array and sort by timestamp (newest first)
        const ordersArray = Object.entries(orders).map(([id, order]) => ({ id, ...order }));
        ordersArray.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
        
        ordersArray.forEach((order) => {
          const statusClass = order.status === 'completed' ? 'status-completed' : 
                            order.status === 'cancelled' ? 'status-cancelled' : 'status-pending';
          
          const orderElement = document.createElement('div');
          orderElement.className = 'grid grid-cols-12 gap-4 px-6 py-4 items-center highlight-row';
          
          // Truncate long IDs for better display
          const shortOrderId = order.id.length > 8 ? order.id.substring(0, 6) + '...' : order.id;
          const shortUserId = order.userId.length > 12 ? order.userId.substring(0, 10) + '...' : order.userId;
          
          orderElement.innerHTML = `
            <div class="col-span-1">
              <div class="text-sm font-medium text-gray-900">${shortOrderId}</div>
              <div class="text-xs text-gray-500">${formatDate(order.timestamp).split(',')[0]}</div>
            </div>
            <div class="col-span-2">
              <div class="text-sm font-medium text-gray-900">${order.nickname || 'No nickname'}</div>
              <div class="text-xs text-gray-500">${shortUserId}</div>
            </div>
            <div class="col-span-1 text-sm text-gray-500">${order.serverId}</div>
            <div class="col-span-1 text-sm text-gray-500">${order.diamondAmount}</div>
            <div class="col-span-1 text-sm text-gray-500">${order.quantity}</div>
            <div class="col-span-1 text-sm font-medium text-blue-600">Rp${formatNumber(order.total)}</div>
            <div class="col-span-2">
              <div class="text-sm text-gray-500">${order.paymentMethod}</div>
              <div class="text-xs text-gray-400">${order.paymentMethod.includes('Transfer') ? 'Manual' : 'Automatic'}</div>
            </div>
            <div class="col-span-1">
              <span class="px-2 py-1 text-xs font-medium rounded-full ${statusClass}">${order.status.charAt(0).toUpperCase() + order.status.slice(1)}</span>
            </div>
            <div class="col-span-2 flex justify-end space-x-2">
              <button class="view-order-btn inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" data-orderid="${order.id}">
                <i class="fas fa-eye mr-1"></i> View
              </button>
              <button class="delete-order-btn inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500" data-orderid="${order.id}">
                <i class="fas fa-trash mr-1"></i>
              </button>
            </div>
          `;
          
          ordersContainer.appendChild(orderElement);
        });
        
        // Add event listeners to view buttons
        document.querySelectorAll('.view-order-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            const orderId = this.getAttribute('data-orderid');
            showOrderDetails(orderId);
          });
        });
        
        // Add event listeners to delete buttons
        document.querySelectorAll('.delete-order-btn').forEach(btn => {
          btn.addEventListener('click', function() {
            const orderId = this.getAttribute('data-orderid');
            if (confirm('Are you sure you want to delete this order?')) {
              deleteOrder(orderId);
            }
          });
        });
      });
    }

    // Show order details
    function showOrderDetails(orderId) {
      const orderRef = database.ref(`orders/${orderId}`);
      const modal = document.getElementById('orderDetailModal');
      const content = document.getElementById('orderDetailContent');
      const completeBtn = document.getElementById('completeOrderBtn');
      const cancelBtn = document.getElementById('cancelOrderBtn');
      
      content.innerHTML = `
        <div class="text-center py-8">
          <i class="fas fa-circle-notch fa-spin text-2xl text-blue-500"></i>
          <p class="mt-2 text-sm text-gray-500">Loading order details...</p>
        </div>
      `;
      modal.classList.remove('hidden');
      
      orderRef.once('value').then((snapshot) => {
        const order = snapshot.val();
        
        if (!order) {
          content.innerHTML = `
            <div class="text-center py-8">
              <i class="fas fa-exclamation-triangle text-2xl text-red-500"></i>
              <p class="mt-2 text-sm text-red-500">Order not found</p>
            </div>
          `;
          return;
        }
        
        const statusClass = order.status === 'completed' ? 'status-completed' : 
                          order.status === 'cancelled' ? 'status-cancelled' : 'status-pending';
        
        content.innerHTML = `
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Order Information -->
            <div class="bg-gray-50 p-4 rounded-lg">
              <h4 class="text-lg font-medium text-gray-900 mb-3 border-b pb-2">Order Information</h4>
              <div class="space-y-3">
                <div class="flex justify-between">
                  <span class="text-sm font-medium text-gray-500">Order ID:</span>
                  <span class="text-sm text-gray-900">${orderId}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-sm font-medium text-gray-500">Status:</span>
                  <span class="text-sm"><span class="px-2 py-1 rounded-full ${statusClass}">${order.status.charAt(0).toUpperCase() + order.status.slice(1)}</span></span>
                </div>
                <div class="flex justify-between">
                  <span class="text-sm font-medium text-gray-500">Date:</span>
                  <span class="text-sm text-gray-900">${formatDate(order.timestamp)}</span>
                </div>
              </div>
            </div>
            
            <!-- Game Information -->
            <div class="bg-gray-50 p-4 rounded-lg">
              <h4 class="text-lg font-medium text-gray-900 mb-3 border-b pb-2">Game Information</h4>
              <div class="space-y-3">
                <div class="flex justify-between">
                  <span class="text-sm font-medium text-gray-500">Game:</span>
                  <span class="text-sm text-gray-900">${order.game || 'Mobile Legends'}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-sm font-medium text-gray-500">Diamonds:</span>
                  <span class="text-sm text-gray-900">${order.diamondAmount} (Rp${formatNumber(order.diamondPrice)} each)</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-sm font-medium text-gray-500">Quantity:</span>
                  <span class="text-sm text-gray-900">${order.quantity}</span>
                </div>
              </div>
            </div>
            
            <!-- Account Information -->
            <div class="bg-gray-50 p-4 rounded-lg">
              <h4 class="text-lg font-medium text-gray-900 mb-3 border-b pb-2">Account Information</h4>
              <div class="space-y-3">
                <div class="flex justify-between">
                  <span class="text-sm font-medium text-gray-500">User ID:</span>
                  <span class="text-sm text-gray-900">${order.userId}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-sm font-medium text-gray-500">Server ID:</span>
                  <span class="text-sm text-gray-900">${order.serverId}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-sm font-medium text-gray-500">Nickname:</span>
                  <span class="text-sm text-gray-900">${order.nickname || '-'}</span>
                </div>
              </div>
            </div>
            
            <!-- Customer Information -->
            <div class="bg-gray-50 p-4 rounded-lg">
              <h4 class="text-lg font-medium text-gray-900 mb-3 border-b pb-2">Customer Information</h4>
              <div class="space-y-3">
                <div class="flex justify-between">
                  <span class="text-sm font-medium text-gray-500">Email:</span>
                  <span class="text-sm text-gray-900">${order.email}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-sm font-medium text-gray-500">WhatsApp:</span>
                  <span class="text-sm text-gray-900">${order.whatsapp}</span>
                </div>
              </div>
            </div>
            
            <!-- Payment Information -->
            <div class="md:col-span-2 bg-gray-50 p-4 rounded-lg">
              <h4 class="text-lg font-medium text-gray-900 mb-3 border-b pb-2">Payment Information</h4>
              <div class="space-y-3">
                <div class="flex justify-between">
                  <span class="text-sm font-medium text-gray-500">Payment Method:</span>
                  <span class="text-sm text-gray-900">${order.paymentMethod}</span>
                </div>
                <div class="flex justify-between">
                  <span class="text-sm font-medium text-gray-500">Subtotal:</span>
                  <span class="text-sm text-gray-900">Rp${formatNumber(order.subtotal)}</span>
                </div>
                ${order.discount > 0 ? `
                <div class="flex justify-between">
                  <span class="text-sm font-medium text-gray-500">Discount:</span>
                  <span class="text-sm text-red-500">-Rp${formatNumber(order.discount)} (${order.promoCode || 'Promo'})</span>
                </div>
                ` : ''}
                <div class="flex justify-between">
                  <span class="text-sm font-medium text-gray-500">Admin Fee:</span>
                  <span class="text-sm text-gray-900">Rp${formatNumber(order.adminFee)}</span>
                </div>
                <div class="flex justify-between border-t pt-2 mt-2">
                  <span class="text-sm font-bold text-gray-700">Total Amount:</span>
                  <span class="text-sm font-bold text-blue-600">Rp${formatNumber(order.total)}</span>
                </div>
              </div>
            </div>
          </div>
        `;
        
        // Show/hide action buttons based on order status
        completeBtn.classList.add('hidden');
        cancelBtn.classList.add('hidden');
        
        if (order.status === 'pending') {
          completeBtn.classList.remove('hidden');
          cancelBtn.classList.remove('hidden');
          
          completeBtn.onclick = function() {
            if (confirm('Mark this order as completed?')) {
              updateOrderStatus(orderId, 'completed');
            }
          };
          
          cancelBtn.onclick = function() {
            if (confirm('Cancel this order?')) {
              updateOrderStatus(orderId, 'cancelled');
            }
          };
        }
      });
    }

    // Update order status
    function updateOrderStatus(orderId, status) {
      const orderRef = database.ref(`orders/${orderId}`);
      
      orderRef.update({ status: status })
        .then(() => {
          // Show success notification
          const modal = document.getElementById('orderDetailModal');
          modal.classList.add('hidden');
          
          // Create and show notification
          const notification = document.createElement('div');
          notification.className = 'fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded-md shadow-lg flex items-center';
          notification.innerHTML = `
            <i class="fas fa-check-circle mr-2"></i>
            Order status updated to ${status.charAt(0).toUpperCase() + status.slice(1)}
          `;
          document.body.appendChild(notification);
          
          // Remove notification after 3 seconds
          setTimeout(() => {
            notification.classList.add('opacity-0', 'transition-opacity', 'duration-300');
            setTimeout(() => notification.remove(), 300);
          }, 3000);
          
          // Reload orders to reflect changes
          loadOrders();
        })
        .catch((error) => {
          console.error('Error updating order:', error);
          alert('Failed to update order status');
        });
    }

    // Delete order
    function deleteOrder(orderId) {
      const orderRef = database.ref(`orders/${orderId}`);
      
      orderRef.remove()
        .then(() => {
          // Show success notification
          const notification = document.createElement('div');
          notification.className = 'fixed bottom-4 right-4 bg-green-500 text-white px-4 py-2 rounded-md shadow-lg flex items-center';
          notification.innerHTML = `
            <i class="fas fa-check-circle mr-2"></i>
            Order deleted successfully
          `;
          document.body.appendChild(notification);
          
          // Remove notification after 3 seconds
          setTimeout(() => {
            notification.classList.add('opacity-0', 'transition-opacity', 'duration-300');
            setTimeout(() => notification.remove(), 300);
          }, 3000);
          
          // Reload orders to reflect changes
          loadOrders();
        })
        .catch((error) => {
          console.error('Error deleting order:', error);
          alert('Failed to delete order');
        });
    }

    // Close modal
    document.getElementById('closeDetailModal').addEventListener('click', function() {
      document.getElementById('orderDetailModal').classList.add('hidden');
    });

    document.getElementById('closeModalBtn').addEventListener('click', function() {
      document.getElementById('orderDetailModal').classList.add('hidden');
    });

    // Refresh button
    document.getElementById('refreshBtn').addEventListener('click', function() {
      this.innerHTML = '<i class="fas fa-sync-alt fa-spin mr-2"></i> Refreshing...';
      loadOrders();
      setTimeout(() => {
        this.innerHTML = '<i class="fas fa-sync-alt mr-2"></i> Refresh';
      }, 1000);
    });

    // Load orders when page loads
    window.addEventListener('load', loadOrders);
  </script>
</body>
</html>
